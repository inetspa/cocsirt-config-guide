# ‡∏£‡∏ß‡∏ö‡∏£‡∏ß‡∏° KB ‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç VA Scan

## üìë [Critical] Apache 2.4.x
![apache2.4.x](./assets/apache2.4.x.jpg)

***Service***

    - Apache 443/TCP
    - ‡πÄ‡∏Å‡∏¥‡∏î‡∏Å‡∏±‡∏ö Apache version 2.4.x ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á
    - Windows ‡πÄ‡∏Å‡∏¥‡∏î‡∏Å‡∏±‡∏ö‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏° XAMPP, WAMP ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ Apache version ‡πÄ‡∏Å‡πà‡∏≤
    - Apache ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ó‡∏≥‡∏Å‡∏≤‡∏£ Config Hardening  

***Solution***
    
Upgrade Apache ‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô Version ‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î ‡πÇ‡∏î‡∏¢‡∏Ç‡∏∂‡πâ‡∏ô‡∏≠‡∏¢‡∏π‡πà‡∏Å‡∏±‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏´‡∏ô‡πâ‡∏≤‡∏á‡∏≤‡∏ô‡∏´‡∏≤‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡πÅ‡∏•‡πâ‡∏ß‡∏ß‡πà‡∏≤‡∏Å‡∏≤‡∏£ Upgrade version ‡πÅ‡∏•‡πâ‡∏ß‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡∏Å‡∏±‡∏ö‡∏£‡∏∞‡∏ö‡∏ö ‡πÅ‡∏•‡∏∞ Web ‡∏Å‡πá‡πÉ‡∏´‡πâ‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á‡∏Å‡∏≤‡∏£ Upgrade ‡πÅ‡∏•‡πâ‡∏ß‡πÑ‡∏õ‡∏ó‡∏≥‡∏Å‡∏≤‡∏£ Hardening

***Hardening***

**‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏£‡∏£‡∏∞‡∏ß‡∏±‡∏á** ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Apache version 2.4.x ‡∏Ç‡∏∂‡πâ‡∏ô‡πÑ‡∏õ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô ‡∏´‡∏≤‡∏Å‡πÄ‡∏õ‡πá‡∏ô Apache version 2.2.x ‡πÉ‡∏´‡πâ‡∏û‡∏¥‡∏à‡∏≤‡∏£‡∏ì‡∏≤‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Å‡∏≤‡∏£ Upgrade apache version ‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏≤‡∏Å Apache version 2.2.x ‡∏°‡∏µ‡πÇ‡∏≠‡∏Å‡∏≤‡∏™‡πÑ‡∏°‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö TLSv1.x ‡πÅ‡∏•‡∏∞‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ Apply security ‡∏ó‡∏µ‡πà‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÑ‡∏î‡πâ

1. ‡πÄ‡∏û‡∏¥‡πà‡∏° config ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏õ‡∏¥‡∏î‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡πÅ‡∏™‡∏î‡∏á version ‡∏Ç‡∏≠‡∏á httpd ‡πÉ‡∏ô‡πÑ‡∏ü‡∏•‡πå `/etc/httpd/conf/httpd.conf`
```apache
# Hide version for security reason
ServerTokens Prod
ServerSignature Off
```

2. ‡πÄ‡∏û‡∏¥‡πà‡∏° configuration ‡πÉ‡∏ô‡πÑ‡∏ü‡∏•‡πå `/etc/httpd/conf.d/ssl.conf` ‡∏´‡∏≤‡∏Å‡πÉ‡∏ô‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏° XAMPP ‡∏Å‡πá‡∏î‡∏π‡∏ó‡∏µ‡πà‡πÑ‡∏ü‡∏•‡πå `ssl.conf` ‡∏´‡∏£‡∏∑‡∏≠‡∏à‡∏∞‡πÄ‡∏≠‡∏≤‡πÑ‡∏ß‡πâ‡∏ó‡∏µ‡πà‡πÑ‡∏ü‡∏•‡πå `httpd.conf` ‡∏Å‡πá‡πÑ‡∏î‡πâ ‡∏´‡∏≤‡∏Å‡∏´‡∏≤‡πÑ‡∏ü‡∏•‡πå `ssl.conf` ‡πÑ‡∏°‡πà‡πÄ‡∏à‡∏≠
```apache
<IfModule mod_ssl.c>
    # HTTPS Strength Config
    SSLProtocol -All +TLSv1.2 +TLSv1.3
    SSLHonorCipherOrder on
    SSLCompression      off
    SSLSessionTickets   off
    # Disable weak ciphers
    SSLCipherSuite EECDH:EDH:!NULL:!SSLv2:!RC4:!aNULL:!3DES:!IDEA:!SHA1:!SHA256:!SHA384
</IfModule>
```
* ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç config ‡πÉ‡∏´‡πâ‡∏ó‡∏≥‡∏Å‡∏≤‡∏£ ‡∏£‡∏±‡∏ô `sudo httpd -t` ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ó‡∏î‡∏™‡∏≠‡∏ö configuration compatible ‡∏î‡πâ‡∏ß‡∏¢ ‡∏´‡∏≤‡∏Å‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î ‡∏à‡∏∞‡πÑ‡∏î‡πâ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Å‡πà‡∏≠‡∏ô‡πÑ‡∏î‡πâ ‡∏Å‡∏£‡∏ì‡∏µ‡πÄ‡∏õ‡πá‡∏ô Windows ‡∏Å‡πá‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏õ‡∏¥‡∏î `CMD` ‡∏Ç‡∏∂‡πâ‡∏ô‡∏°‡∏≤‡πÅ‡∏•‡πâ‡∏ß‡∏û‡∏¥‡∏°‡∏û‡∏¥‡πå‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á `httpd -t` ‡πÑ‡∏î‡πâ‡πÄ‡∏ä‡πà‡∏ô‡∏Å‡∏±‡∏ô
* ‡∏´‡∏≤‡∏Å‡∏•‡∏≠‡∏á‡∏£‡∏±‡∏ô‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á `sudo httpd -t` ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÅ‡∏•‡πâ‡∏ß‡∏û‡∏ö‡∏ß‡πà‡∏≤ Protocol `TLSv1.3` ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö ‡∏Å‡πá‡πÉ‡∏´‡πâ‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏ï‡∏£‡∏á `+TLSv1.3` ‡∏≠‡∏≠‡∏Å‡πÑ‡∏î‡πâ ‡πÅ‡∏•‡πâ‡∏ß‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á

3. ‡∏ó‡∏≥‡∏Å‡∏≤‡∏£ Restart apache service ‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á `sudo systemctl restart httpd` ‡∏´‡∏≤‡∏Å‡πÄ‡∏õ‡πá‡∏ô Windows ‡∏Å‡πá‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡∏¥‡∏î‡πÑ‡∏õ‡∏ó‡∏µ‡πà `Windows service` ‡πÅ‡∏•‡πâ‡∏ß‡∏´‡∏≤ service ‡∏ó‡∏µ‡πà‡∏ä‡∏∑‡πà‡∏≠‡∏ß‡πà‡∏≤ `Apache` ‡πÅ‡∏•‡πâ‡∏ß‡∏ó‡∏≥‡∏Å‡∏≤‡∏£ Restart

## üìë [Critical] PHP Version ‡πÄ‡∏Å‡πà‡∏≤‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ

***Service***

    - Web Service 80/TCP, 443/TCP
    - PHP

***Solution***

Upgrade ‡πÑ‡∏õ‡πÉ‡∏ä‡πâ PHP Version ‡πÉ‡∏´‡∏°‡πà‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç Security bugs ‡πÅ‡∏•‡πâ‡∏ß ‡πÅ‡∏ï‡πà‡∏Å‡∏≤‡∏£ Upgrade PHP Version ‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏™‡∏π‡∏á‡∏°‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏ó‡∏≥‡πÉ‡∏´‡πâ Web Application ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏õ‡∏Å‡∏ï‡∏¥ ‡∏à‡∏∂‡∏á‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á‡πÉ‡∏´‡πâ‡πÑ‡∏õ Hardening ‡πÅ‡∏ó‡∏ô

***Hardening***

‡∏Å‡∏≤‡∏£ Hardening PHP ‡∏Å‡πá‡∏Ñ‡∏∑‡∏≠ ‡∏Å‡∏≤‡∏£‡∏õ‡∏¥‡∏î Expose version ‡∏Ç‡∏≠‡∏á PHP ‡∏≠‡∏≠‡∏Å‡πÑ‡∏õ ‡πÇ‡∏î‡∏¢‡∏°‡∏µ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏î‡∏±‡∏á‡∏ô‡∏µ‡πâ
1. ‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ó‡∏µ‡πà‡πÑ‡∏ü‡∏•‡πå `/etc/php.ini` ‡∏´‡∏£‡∏∑‡∏≠‡∏´‡∏≤‡∏Å‡πÄ‡∏õ‡πá‡∏ô XAMPP ‡∏Å‡πá‡πÉ‡∏´‡πâ‡πÅ‡∏Å‡πâ‡πÑ‡∏ü‡∏•‡πå‡∏ä‡∏∑‡πà‡∏≠ `php.ini`
2. ‡∏´‡∏≤‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Ñ‡∏≥‡∏ß‡πà‡∏≤ `expose_php = On` ‡πÅ‡∏•‡∏∞‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô `expose_php = Off`
3. Restart service Apache ‡πÅ‡∏ï‡πà‡∏´‡∏≤‡∏Å‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÄ‡∏õ‡πá‡∏ô php-fpm ‡∏Å‡πá‡πÉ‡∏´‡πâ‡∏ó‡∏≥‡∏Å‡∏≤‡∏£ Restart service php-fpm 

## üìë [Critical] 73756 - Microsoft SQL Server Unsupported Version Detection (remote check)
![73756](./assets/73756.png)

***Service***

    - MS SQL Server version ‡∏ô‡πâ‡∏≠‡∏¢‡∏Å‡∏ß‡πà‡∏≤ 2016
    - MS SQL Express version ‡∏ô‡πâ‡∏≠‡∏¢‡∏Å‡∏ß‡πà‡∏≤ 2016
    - tcp/1433/mssql

***Solution***

‡πÉ‡∏´‡πâ‡πÅ‡∏à‡πâ‡∏á Vendor ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ó‡∏≥‡∏Å‡∏≤‡∏£ Upgrade version SQL ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡πÄ‡∏õ‡πá‡∏ô Version ‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î ‡∏´‡∏≤‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏ß‡πà‡∏≤‡∏Å‡∏≤‡∏£ Upgrade version ‡∏ô‡∏±‡πâ‡∏ô‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏£‡∏∞‡∏ö‡∏ö‡∏•‡πà‡∏° ‡∏Å‡πá‡πÉ‡∏´‡πâ‡∏û‡∏¥‡∏à‡∏≤‡∏£‡∏ì‡∏≤‡∏Å‡∏≤‡∏£‡∏ó‡∏≥ Hardening

***Hardening***

‡πÄ‡∏õ‡∏¥‡∏î Windows Firewall ‡πÉ‡∏´‡πâ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á Server ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ Access ‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô SQL Server ‡πÑ‡∏î‡πâ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô ‡πÅ‡∏•‡∏∞‡∏õ‡∏¥‡∏î‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏≠‡∏∑‡πà‡∏ô‡πÜ ‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤‡∏¢‡∏±‡∏á SQL Server ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ô‡∏µ‡πâ‡πÑ‡∏î‡πâ

## üìë [High] 35291 - SSL Certificate Signed Using Weak Hashing Algorithm
![35291](./assets/35291.png)

***Service***

    - Remote Desktop 3389/TCP
    - SQL Server 1433/TCP
    - IIS 443/TCP
    - HTTPAPI/2.0 443/TCP

***Solution***

‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏≤‡∏Å Cert ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏≠‡∏¢‡∏π‡πà‡∏Ç‡∏≠‡∏á Service ‡πÉ‡∏ä‡πâ `SHA1` ‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô weak hash algorithm ‡∏ï‡∏≤‡∏°‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏Ñ‡∏∑‡∏≠‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ `SHA256` ‡∏Ç‡∏∂‡πâ‡∏ô‡πÑ‡∏õ

1. Generate Self signed cert ‡πÇ‡∏î‡∏¢‡∏à‡∏∞‡πÉ‡∏ä‡πâ Program ‡∏´‡∏£‡∏∑‡∏≠‡∏ú‡πà‡∏≤‡∏ô `openssl` command line ‡∏Å‡πá‡πÑ‡∏î‡πâ ‡∏à‡∏≤‡∏Å‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏à‡∏∞ Convert ‡πÇ‡∏î‡∏¢‡πÉ‡∏ä‡πâ `openssl`
```bash
openssl req -x509 -newkey rsa:4096 \
 -sha256 -days 3650 -nodes \
 -keyout selfsigned.key \
 -out selfsigned.crt \
 -subj "/CN=___WINDOWS_HOSTNAME___"
```
‡πÇ‡∏î‡∏¢‡∏ó‡∏µ‡πà‡∏ä‡∏∑‡πà‡∏≠ `___WINDOWS_HOSTNAME___` ‡∏à‡∏∞‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏ä‡∏∑‡πà‡∏≠‡∏Ç‡∏≠‡∏á SQL Server ‡∏ñ‡∏∂‡∏á‡∏à‡∏∞‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ

‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡∏£‡∏±‡∏ô‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡∏à‡∏∞‡∏û‡∏≠‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏°‡∏≤ 2 ‡πÑ‡∏ü‡∏•‡πå‡∏Ñ‡∏∑‡∏≠ Private Key file `selfsigned.key` ‡πÅ‡∏•‡∏∞ Cert file `selfsigned.crt`

2. ‡πÅ‡∏õ‡∏•‡∏á Self signed cert ‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô Format `PEM` ‡πÉ‡∏´‡πâ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö format ‡∏Ç‡∏≠‡∏á `pfx` ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Windows
```bash
openssl pkcs12 -inkey selfsigned.key -in selfsigned.crt -export -out selfsigned.pfx
```
‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÅ‡∏õ‡∏•‡∏á‡πÑ‡∏ü‡∏•‡πå‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡∏à‡∏∞‡∏û‡∏ö‡∏ß‡πà‡∏≤‡∏°‡∏µ‡πÑ‡∏ü‡∏•‡πå `selfsigned.pfx` ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤

3. ‡∏ó‡∏≥‡∏Å‡∏≤‡∏£ Import file `selfsigned.pfx` ‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ‡πÉ‡∏ô Windows
 - ‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡∏Å‡∏î `Win+R` ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏¥‡∏î run command
 - ‡∏û‡∏¥‡∏°‡∏û‡πå `mmc` ‡πÅ‡∏•‡∏∞‡∏Å‡∏î enter
 - ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ï‡∏£‡∏á `Personal` ‡πÅ‡∏•‡∏∞‡∏Ñ‡∏•‡∏¥‡∏Å‡∏Ç‡∏ß‡∏≤ ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å `import`
 - ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå `pfx` ‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡πÑ‡∏î‡πâ‡∏ó‡∏≥‡∏Å‡∏≤‡∏£ convert ‡πÑ‡∏ß‡πâ‡πÅ‡∏•‡πâ‡∏ß‡πÉ‡∏ô‡∏Ç‡πâ‡∏≠ 2

![Cert import](../assets/win-cert-import.png)

4. ‡∏´‡∏≤‡∏Å‡πÄ‡∏õ‡πá‡∏ô SQL Server ‡∏´‡∏£‡∏∑‡∏≠ SQL Express ‡πÉ‡∏´‡πâ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÉ‡∏´‡πâ User ‡∏Ç‡∏≠‡∏á Service ‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤‡∏≠‡πà‡∏≤‡∏ô‡πÑ‡∏ü‡∏•‡πå Cert ‡πÇ‡∏î‡∏¢‡∏Ñ‡∏•‡∏¥‡∏Å‡∏Ç‡∏ß‡∏≤‡∏ó‡∏µ‡πà Cert ‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤ import ‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ‡πÅ‡∏•‡∏∞‡πÄ‡∏•‡∏∑‡∏≠‡∏Å `All Tasks` > `Manage Private Keys...`

![Cert manage](../assets/win-cert-manage.png)
 
- SQL Server ‡πÉ‡∏´‡πâ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÉ‡∏´‡πâ User `NT USER\MSSQLSERVER`
- SQL Express ‡πÉ‡∏´‡πâ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÉ‡∏´‡πâ User `NETWORk SERVICE`

5. ‡∏ó‡∏≥‡∏Å‡∏≤‡∏£ Config Service ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô Cert ‡πÉ‡∏´‡∏°‡πà‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏û‡∏¥‡πà‡∏á Import ‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ

- SQL Serve ‡πÅ‡∏•‡∏∞ SQL Express ‡πÉ‡∏´‡πâ‡∏ó‡∏≥‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏Å‡∏±‡∏ô‡∏ï‡∏≤‡∏°‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏î‡∏±‡∏á‡∏ô‡∏µ‡πâ
    1. ‡πÄ‡∏õ‡∏¥‡∏î `SQL Server Configuration Manager` ‡∏Ç‡∏∂‡πâ‡∏ô‡∏°‡∏≤‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡∏µ‡πà `Protocol for MSSQLSERVER` ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏Ç‡∏ß‡∏≤ ‡πÅ‡∏•‡∏∞‡πÄ‡∏•‡∏∑‡∏≠‡∏Å `Properties`
    ![SQL Prop](../assets/win-sql-prop.png)
    2. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å tab `Certificate` ‡πÅ‡∏•‡∏∞‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Cert ‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡πÉ‡∏™‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ ‡πÅ‡∏•‡πâ‡∏ß‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡∏Å‡∏î `OK` ‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡∏ô‡∏±‡πâ‡∏ô‡∏ó‡∏≥‡∏Å‡∏≤‡∏£ Restart SQL Server ‡πÅ‡∏•‡∏∞‡∏•‡∏≠‡∏á‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á
    ![SQL Cert](../assets/win-sql-cert.png)
    3. ‡πÄ‡∏õ‡∏¥‡∏î Service ‡∏Ç‡∏∂‡πâ‡∏ô‡∏°‡∏≤‡πÅ‡∏•‡πâ‡∏ß Restart SQL Server ‡∏´‡∏£‡∏∑‡∏≠ SQL Express ‡πÅ‡∏•‡πâ‡∏ß‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á
    *Credit: https://virtual-dba.com/blog/upgrading-sha1-certificate-sql-server/*

- Remote Desktop (3389/TCP) ‡πÉ‡∏´‡πâ‡∏ó‡∏≥‡∏ï‡∏≤‡∏°‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏î‡∏±‡∏á‡∏ô‡∏µ‡πâ
    1. ‡∏´‡∏≤‡∏Ñ‡πà‡∏≤ FingerPrint ‡∏Ç‡∏≠‡∏á Cert ‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡πÑ‡∏î‡πâ Import ‡πÑ‡∏õ‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏ô‡∏µ‡πâ ‡πÇ‡∏î‡∏¢‡∏Å‡∏≤‡∏£ Double Click ‡∏ó‡∏µ‡πà Cert
    2. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏õ‡∏ó‡∏µ‡πà Tab `Detail` ‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏•‡∏á‡∏°‡∏≤‡∏à‡∏ô‡πÄ‡∏à‡∏≠‡∏Ñ‡∏≥‡∏ß‡πà‡∏≤ `Thumbprint` ‡πÅ‡∏•‡πâ‡∏ß Copy ‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏à‡∏≠‡πÑ‡∏ß‡πâ ‡∏´‡∏≤‡∏Å‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏°‡∏µ‡∏ä‡πà‡∏≠‡∏á‡∏´‡∏ß‡πà‡∏≤ ‡∏Å‡πá‡πÉ‡∏´‡πâ‡∏•‡∏ö‡∏ä‡πà‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏á‡∏≠‡∏≠‡∏Å‡πÉ‡∏´‡πâ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏î‡∏±‡∏á‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á `475da948e4ba44d9b5bc31ab4b8006113fd5f538`
    ![thumbprint](./assets/cert-thumbprint.png)
    3. ‡πÄ‡∏õ‡∏¥‡∏î notepad ‡∏Ç‡∏∂‡πâ‡∏ô‡∏°‡∏≤‡πÅ‡∏•‡∏∞‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á `wmic /namespace:\\root\cimv2\TerminalServices PATH Win32_TSGeneralSetting Set SSLCertificateSHA1Hash="1111111111111111111111111111"` ‡πÇ‡∏î‡∏¢‡∏ô‡∏≥‡∏Ñ‡πà‡∏≤ `Thumbprint` ‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å‡∏Ç‡πâ‡∏≠ 2 ‡∏°‡∏≤‡πÉ‡∏™‡πà‡πÅ‡∏ó‡∏ô `1111111111111111111111111111`
    4. ‡πÄ‡∏õ‡∏¥‡∏î PowerShell ‡∏Ç‡∏∂‡πâ‡∏ô‡∏°‡∏≤ ‡πÇ‡∏î‡∏¢‡πÉ‡∏´‡πâ `Run as Administrator` ‡πÅ‡∏•‡πâ‡∏ß‡∏ô‡∏≥‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏à‡∏±‡∏î‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡πÑ‡∏ß‡πâ‡πÉ‡∏ô‡∏Ç‡πâ‡∏≠ 3 ‡πÉ‡∏™‡πà‡∏•‡∏á‡πÑ‡∏õ ‡πÅ‡∏•‡πâ‡∏ß‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡∏Å‡∏î Enter ‡∏´‡∏≤‡∏Å‡∏ú‡∏•‡πÅ‡∏™‡∏î‡∏á‡∏ö‡∏≠‡∏Å‡∏ß‡πà‡∏≤ `Property(s) update successful` ‡∏Å‡πá‡πÄ‡∏õ‡πá‡∏ô‡∏≠‡∏±‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à
    ![applied](./assets/rdp-cert-apply.png)

- IIS (443/TCP) ‡πÉ‡∏´‡πâ‡∏ó‡∏≥‡∏ï‡∏≤‡∏°‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏î‡∏±‡∏á‡∏ô‡∏µ‡πâ ***TODO Later***

- HTTPAPI/2.0 (443/TCP) ‡πÉ‡∏´‡πâ‡∏ó‡∏≥‡∏ï‡∏≤‡∏°‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏î‡∏±‡∏á‡∏ô‡∏µ‡πâ
    1. ‡∏´‡∏≤ FingerPrint ‡∏Ç‡∏≠‡∏á Cert ‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡πÉ‡∏™‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤ ‡πÇ‡∏î‡∏¢‡πÉ‡∏ä‡πâ‡∏ß‡∏¥‡∏ò‡∏µ‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô‡∏Å‡∏±‡∏ö‡∏Ç‡∏≠‡∏á Remote Desktop ‡∏´‡∏£‡∏∑‡∏≠‡∏à‡∏∞‡πÉ‡∏ä‡πâ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á `dir cert:\localmachine\my` ‡πÉ‡∏ô PowerShell ‡∏Å‡πá‡πÑ‡∏î‡πâ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏Å‡∏±‡∏ô
    2. ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÑ‡∏î‡πâ FingerPrint ‡∏°‡∏≤‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡πá‡πÉ‡∏´‡πâ‡πÄ‡∏Å‡πá‡∏ö‡πÑ‡∏ß‡πâ‡πÉ‡∏ô notepad ‡πÇ‡∏î‡∏¢ FingerPrint ‡∏à‡∏∞‡∏°‡∏µ‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏î‡∏±‡∏á‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡∏µ‡πâ `13CA91A2E446000863E10156A6748DE70885F29A`
    3. ‡πÄ‡∏õ‡∏¥‡∏î CMD ‡∏Ç‡∏∂‡πâ‡∏ô‡∏°‡∏≤ ‡πÇ‡∏î‡∏¢‡πÉ‡∏ä‡πâ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå Administrator ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Service `netsh http show sslcert` ‡∏à‡∏∞‡∏û‡∏ö Service ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏≠‡∏¢‡∏π‡πà ‡πÉ‡∏´‡πâ Copy ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏´‡∏•‡πà‡∏≤‡∏ô‡∏µ‡πâ‡πÑ‡∏ß‡πâ
        - Port ‡πÄ‡∏ä‡πà‡∏ô `0.0.0.0:443`
        - Cert Hash ‡∏Ç‡∏≠‡∏á‡πÄ‡∏î‡∏¥‡∏° ‡πÄ‡∏ä‡πà‡∏ô `e9d293e563cc374774bdb90007f7ef618c336f48`
        - Application ID ‡πÄ‡∏ä‡πà‡∏ô `{85118119-e5f5-40da-b837-4acbd51d62f0}`
    4. ‡∏ó‡∏≥‡∏Å‡∏≤‡∏£ Delete Cert ‡∏ï‡∏±‡∏ß‡πÄ‡∏Å‡πà‡∏≤‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏≠‡∏¢‡∏π‡πà‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á `netsh http delete sslcert ___PORT___` ‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á `___PORT___` ‡∏ô‡∏±‡πâ‡∏ô‡πÉ‡∏´‡πâ‡πÄ‡∏≠‡∏≤ Port ‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å‡∏Ç‡πâ‡∏≠ 3 ‡∏°‡∏≤‡πÉ‡∏™‡πà ‡∏à‡∏∞‡πÑ‡∏î‡πâ‡∏î‡∏±‡∏á‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á `netsh http delete sslcert 0.0.0.0:443` ‡πÅ‡∏•‡∏∞‡∏´‡∏≤‡∏Å Result ‡∏Ç‡∏∂‡πâ‡∏ô‡∏ß‡πà‡∏≤ `SSL Certificate successfully deleted` ‡∏Å‡πá‡πÄ‡∏õ‡πá‡∏ô‡∏≠‡∏±‡∏ô‡πÉ‡∏ä‡πâ‡πÑ‡∏î‡πâ
    5. ‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏° Cert ‡∏Ç‡∏≠‡∏á‡πÄ‡∏£‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ‡πÉ‡∏ô Service ‡πÇ‡∏î‡∏¢‡∏ô‡∏≥‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡∏Ç‡πâ‡∏≠ 2, 4 ‡∏°‡∏≤‡πÉ‡∏™‡πà ‡∏à‡∏∞‡πÑ‡∏î‡πâ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏î‡∏±‡∏á‡∏ô‡∏µ‡πâ `netsh http add sslcert 0.0.0.0:443 certhash=13CA91A2E446000863E10156A6748DE70885F29A appid={85118119-e5f5-40da-b837-4acbd51d62f0} certstorename=My` ‡∏´‡∏≤‡∏Å‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡∏¥‡πå‡∏Ç‡∏∂‡πâ‡∏ô‡∏ß‡πà‡∏≤ `SSL Certificate successfully added` ‡∏Å‡πá‡πÄ‡∏õ‡πá‡∏ô‡∏≠‡∏±‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢


## üìë [Medium] 65821 - SSL RC4 Cipher Suites Supported (Bar Mitzvah)
![65821](./assets/65821.png)

***Service***

    - Windows RDP 3389/TCP

***Solution***

    ***TODO Later***

## üìë [Medium] 104743 - TLS Version 1.0 Protocol Detection
![104743](./assets/104743.png)

***Service***

    - Windows RDP 3389/TCP

    ***TODO Later***

## üìë [Medium] 157288 - TLS Version 1.1 Deprecated Protocol
![157288](./assets/157288.png)

***Service***

    - Windows RDP 3389/TCP

***Solution***

    ***TODO Later***

## üìë [Medium] 187315 - SSH Terrapin Prefix Truncation Weakness (CVE-2023-48795)
![187315](./assets/187315.png)

***Service***

    - Linux SSH 22/TCP

***Solution***

    ***TODO Later***

## üìë [Low] 70658 - SSH Server CBC Mode Ciphers Enabled
![70658](./assets/70658.png)

***Service***

    - Linux SSH 22/TCP

***Solution***

    ***TODO Later***

## üìë [Low] 153953 - SSH Weak Key Exchange Algorithms Enabled
![153953](./assets/153953.png)

***Service***

    - Linux SSH 22/TCP

***Solution***

    ***TODO Later***

